{
  "description": "FlowMetric is the Schema for the flowmetrics API",
  "type": "object",
  "properties": {
    "apiVersion": {
      "description": "APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources",
      "type": [
        "string",
        "null"
      ],
      "enum": [
        "flows.netobserv.io/v1alpha1"
      ]
    },
    "kind": {
      "description": "Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds",
      "type": [
        "string",
        "null"
      ],
      "enum": [
        "FlowMetric"
      ]
    },
    "metadata": {
      "description": "Standard object's metadata. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#metadata",
      "$ref": "_definitions.json#/definitions/io.k8s.apimachinery.pkg.apis.meta.v1.ObjectMeta"
    },
    "spec": {
      "description": "FlowMetricSpec defines the desired state of FlowMetric The provided API allows you to customize these metrics according to your needs.<br> When adding new metrics or modifying existing labels, you must carefully monitor the memory usage of Prometheus workloads as this could potentially have a high impact. Cf https://rhobs-handbook.netlify.app/products/openshiftmonitoring/telemetry.md/#what-is-the-cardinality-of-a-metric<br> To check the cardinality of all NetObserv metrics, run as `promql`: `count({__name__=~\"netobserv.*\"}) by (__name__)`.",
      "type": [
        "object",
        "null"
      ],
      "required": [
        "metricName",
        "type"
      ],
      "properties": {
        "buckets": {
          "description": "A list of buckets to use when `type` is \"Histogram\". The list must be parseable as floats. Prometheus default buckets will be used if unset.",
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": [
              "string",
              "null"
            ]
          }
        },
        "direction": {
          "description": "Filter for ingress, egress or any direction flows. When set to `Ingress`, it is equivalent to adding the regex filter on `FlowDirection`: `0|2`. When set to `Egress`, it is equivalent to adding the regex filter on `FlowDirection`: `1|2`.",
          "type": [
            "string",
            "null"
          ],
          "enum": [
            "Any",
            "Egress",
            "Ingress"
          ]
        },
        "filters": {
          "description": "`filters` is a list of fields and values used to restrict which flows are taken into account. Oftentimes, these filters must be used to eliminate duplicates: `Duplicate:\"false\"` and `FlowDirection: \"0\"`. Refer to the documentation for the list of available fields: https://docs.openshift.com/container-platform/latest/networking/network_observability/json-flows-format-reference.html.",
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": [
              "object",
              "null"
            ],
            "required": [
              "field",
              "matchType"
            ],
            "properties": {
              "field": {
                "description": "Name of the field to filter on",
                "type": "string"
              },
              "matchType": {
                "description": "Type of matching to apply",
                "type": "string",
                "enum": [
                  "Exact",
                  "Regex",
                  "Presence",
                  "Absence"
                ]
              },
              "value": {
                "description": "Value to filter on",
                "type": [
                  "string",
                  "null"
                ]
              }
            },
            "additionalProperties": false
          }
        },
        "includeDuplicates": {
          "description": "When set to `true`, flows duplicated across several interfaces will add up in the generated metrics. When set to `false` (default), it is equivalent to adding the exact filter on `Duplicate`: `false`.",
          "type": [
            "boolean",
            "null"
          ]
        },
        "labels": {
          "description": "`labels` is a list of fields that should be used as Prometheus labels, also known as dimensions. From choosing labels results the level of granularity of this metric, as well as the available aggregations at query time. It must be done carefully as it impacts the metric cardinality (cf https://rhobs-handbook.netlify.app/products/openshiftmonitoring/telemetry.md/#what-is-the-cardinality-of-a-metric). In general, avoid setting very high cardinality labels such as IP or MAC addresses. \"SrcK8S_OwnerName\" or \"DstK8S_OwnerName\" should be preferred over \"SrcK8S_Name\" or \"DstK8S_Name\" as much as possible. Refer to the documentation for the list of available fields: https://docs.openshift.com/container-platform/latest/network_observability/json-flows-format-reference.html.",
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": [
              "string",
              "null"
            ]
          }
        },
        "metricName": {
          "description": "Name of the metric in Prometheus. It will be automatically prefixed with \"netobserv_\".",
          "type": "string"
        },
        "type": {
          "description": "Metric type: \"Counter\" or \"Histogram\". Use \"Counter\" for any value that increases over time and on which you can compute a rate, such as Bytes or Packets. Use \"Histogram\" for any value that must be sampled independently, such as latencies.",
          "type": "string",
          "enum": [
            "Counter",
            "Histogram"
          ]
        },
        "valueField": {
          "description": "`valueField` is the flow field that must be used as a value for this metric. This field must hold numeric values. Leave empty to count flows rather than a specific value per flow. Refer to the documentation for the list of available fields: https://docs.openshift.com/container-platform/latest/networking/network_observability/json-flows-format-reference.html.",
          "type": [
            "string",
            "null"
          ]
        }
      },
      "additionalProperties": false
    },
    "status": {
      "description": "FlowMetricStatus defines the observed state of FlowMetric",
      "type": [
        "object",
        "null"
      ]
    }
  },
  "x-kubernetes-group-version-kind": [
    {
      "group": "flows.netobserv.io",
      "kind": "FlowMetric",
      "version": "v1alpha1"
    }
  ],
  "additionalProperties": false,
  "$schema": "http://json-schema.org/schema#"
}