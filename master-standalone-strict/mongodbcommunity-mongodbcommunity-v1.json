{
  "description": "MongoDBCommunity is the Schema for the mongodbs API",
  "type": "object",
  "properties": {
    "apiVersion": {
      "description": "APIVersion defines the versioned schema of this representation of an object. Servers should convert recognized schemas to the latest internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources",
      "type": [
        "string",
        "null"
      ],
      "enum": [
        "mongodbcommunity.mongodb.com/v1"
      ]
    },
    "kind": {
      "description": "Kind is a string value representing the REST resource this object represents. Servers may infer this from the endpoint the client submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds",
      "type": [
        "string",
        "null"
      ],
      "enum": [
        "MongoDBCommunity"
      ]
    },
    "metadata": {
      "description": "Standard object's metadata. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#metadata",
      "$ref": "_definitions.json#/definitions/io.k8s.apimachinery.pkg.apis.meta.v1.ObjectMeta"
    },
    "spec": {
      "description": "MongoDBCommunitySpec defines the desired state of MongoDB",
      "type": [
        "object",
        "null"
      ],
      "required": [
        "security",
        "type",
        "users"
      ],
      "properties": {
        "additionalConnectionStringConfig": {
          "description": "Additional options to be appended to the connection string. These options apply to the entire resource and to each user.",
          "x-kubernetes-preserve-unknown-fields": true
        },
        "additionalMongodConfig": {
          "description": "AdditionalMongodConfig is additional configuration that can be passed to each data-bearing mongod at runtime. Uses the same structure as the mongod configuration file: https://www.mongodb.com/docs/manual/reference/configuration-options/",
          "x-kubernetes-preserve-unknown-fields": true
        },
        "agent": {
          "description": "AgentConfiguration sets options for the MongoDB automation agent",
          "type": [
            "object",
            "null"
          ],
          "properties": {
            "logFile": {
              "type": [
                "string",
                "null"
              ]
            },
            "logLevel": {
              "type": [
                "string",
                "null"
              ]
            },
            "logRotate": {
              "description": "LogRotate if enabled, will enable LogRotate for all processes.",
              "type": [
                "object",
                "null"
              ],
              "required": [
                "sizeThresholdMB",
                "timeThresholdHrs"
              ],
              "properties": {
                "includeAuditLogsWithMongoDBLogs": {
                  "description": "set to 'true' to have the Automation Agent rotate the audit files along with mongodb log files",
                  "type": [
                    "boolean",
                    "null"
                  ]
                },
                "numTotal": {
                  "description": "maximum number of log files to have total",
                  "type": [
                    "integer",
                    "null"
                  ]
                },
                "numUncompressed": {
                  "description": "maximum number of log files to leave uncompressed",
                  "type": [
                    "integer",
                    "null"
                  ]
                },
                "percentOfDiskspace": {
                  "description": "Maximum percentage of the total disk space these log files should take up. The string needs to be able to be converted to float64",
                  "type": [
                    "string",
                    "null"
                  ]
                },
                "sizeThresholdMB": {
                  "description": "Maximum size for an individual log file before rotation. The string needs to be able to be converted to float64. Fractional values of MB are supported.",
                  "type": "string"
                },
                "timeThresholdHrs": {
                  "description": "maximum hours for an individual log file before rotation",
                  "type": "integer"
                }
              },
              "additionalProperties": false
            },
            "maxLogFileDurationHours": {
              "type": [
                "integer",
                "null"
              ]
            },
            "systemLog": {
              "description": "SystemLog configures system log of mongod",
              "type": [
                "object",
                "null"
              ],
              "required": [
                "destination",
                "logAppend",
                "path"
              ],
              "properties": {
                "destination": {
                  "type": "string"
                },
                "logAppend": {
                  "type": "boolean"
                },
                "path": {
                  "type": "string"
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "arbiters": {
          "description": "Arbiters is the number of arbiters to add to the Replica Set. It is not recommended to have more than one arbiter per Replica Set. More info: https://www.mongodb.com/docs/manual/tutorial/add-replica-set-arbiter/",
          "type": [
            "integer",
            "null"
          ]
        },
        "automationConfig": {
          "description": "AutomationConfigOverride is merged on top of the operator created automation config. Processes are merged by name. Currently Only the process.disabled field is supported.",
          "type": [
            "object",
            "null"
          ],
          "required": [
            "processes"
          ],
          "properties": {
            "processes": {
              "type": "array",
              "items": {
                "description": "OverrideProcess contains fields that we can override on the AutomationConfig processes.",
                "type": [
                  "object",
                  "null"
                ],
                "required": [
                  "disabled",
                  "name"
                ],
                "properties": {
                  "disabled": {
                    "type": "boolean"
                  },
                  "logRotate": {
                    "description": "CrdLogRotate is the crd definition of LogRotate including fields in strings while the agent supports them as float64",
                    "type": [
                      "object",
                      "null"
                    ],
                    "required": [
                      "sizeThresholdMB",
                      "timeThresholdHrs"
                    ],
                    "properties": {
                      "includeAuditLogsWithMongoDBLogs": {
                        "description": "set to 'true' to have the Automation Agent rotate the audit files along with mongodb log files",
                        "type": [
                          "boolean",
                          "null"
                        ]
                      },
                      "numTotal": {
                        "description": "maximum number of log files to have total",
                        "type": [
                          "integer",
                          "null"
                        ]
                      },
                      "numUncompressed": {
                        "description": "maximum number of log files to leave uncompressed",
                        "type": [
                          "integer",
                          "null"
                        ]
                      },
                      "percentOfDiskspace": {
                        "description": "Maximum percentage of the total disk space these log files should take up. The string needs to be able to be converted to float64",
                        "type": [
                          "string",
                          "null"
                        ]
                      },
                      "sizeThresholdMB": {
                        "description": "Maximum size for an individual log file before rotation. The string needs to be able to be converted to float64. Fractional values of MB are supported.",
                        "type": "string"
                      },
                      "timeThresholdHrs": {
                        "description": "maximum hours for an individual log file before rotation",
                        "type": "integer"
                      }
                    },
                    "additionalProperties": false
                  },
                  "name": {
                    "type": "string"
                  }
                },
                "additionalProperties": false
              }
            }
          },
          "additionalProperties": false
        },
        "featureCompatibilityVersion": {
          "description": "FeatureCompatibilityVersion configures the feature compatibility version that will be set for the deployment",
          "type": [
            "string",
            "null"
          ]
        },
        "members": {
          "description": "Members is the number of members in the replica set",
          "type": [
            "integer",
            "null"
          ]
        },
        "prometheus": {
          "description": "Prometheus configurations.",
          "type": [
            "object",
            "null"
          ],
          "required": [
            "passwordSecretRef",
            "username"
          ],
          "properties": {
            "metricsPath": {
              "description": "Indicates path to the metrics endpoint.",
              "type": [
                "string",
                "null"
              ],
              "pattern": "^\\/[a-z0-9]+$"
            },
            "passwordSecretRef": {
              "description": "Name of a Secret containing a HTTP Basic Auth Password.",
              "type": "object",
              "required": [
                "name"
              ],
              "properties": {
                "key": {
                  "description": "Key is the key in the secret storing this password. Defaults to \"password\"",
                  "type": [
                    "string",
                    "null"
                  ]
                },
                "name": {
                  "description": "Name is the name of the secret storing this user's password",
                  "type": "string"
                }
              },
              "additionalProperties": false
            },
            "port": {
              "description": "Port where metrics endpoint will bind to. Defaults to 9216.",
              "type": [
                "integer",
                "null"
              ]
            },
            "tlsSecretKeyRef": {
              "description": "Name of a Secret (type kubernetes.io/tls) holding the certificates to use in the Prometheus endpoint.",
              "type": [
                "object",
                "null"
              ],
              "required": [
                "name"
              ],
              "properties": {
                "key": {
                  "description": "Key is the key in the secret storing this password. Defaults to \"password\"",
                  "type": [
                    "string",
                    "null"
                  ]
                },
                "name": {
                  "description": "Name is the name of the secret storing this user's password",
                  "type": "string"
                }
              },
              "additionalProperties": false
            },
            "username": {
              "description": "HTTP Basic Auth Username for metrics endpoint.",
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "replicaSetHorizons": {
          "description": "ReplicaSetHorizons Add this parameter and values if you need your database to be accessed outside of Kubernetes. This setting allows you to provide different DNS settings within the Kubernetes cluster and to the Kubernetes cluster. The Kubernetes Operator uses split horizon DNS for replica set members. This feature allows communication both within the Kubernetes cluster and from outside Kubernetes.",
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": [
              "object",
              "null"
            ],
            "additionalProperties": {
              "type": [
                "string",
                "null"
              ]
            }
          }
        },
        "security": {
          "description": "Security configures security features, such as TLS, and authentication settings for a deployment",
          "type": "object",
          "properties": {
            "authentication": {
              "type": [
                "object",
                "null"
              ],
              "required": [
                "modes"
              ],
              "properties": {
                "agentCertificateSecretRef": {
                  "description": "AgentCertificateSecret is a reference to a Secret containing the certificate and the key for the automation agent The secret needs to have available: - certificate under key: \"tls.crt\" - private key under key: \"tls.key\" If additionally, tls.pem is present, then it needs to be equal to the concatenation of tls.crt and tls.key",
                  "type": [
                    "object",
                    "null"
                  ],
                  "properties": {
                    "name": {
                      "description": "Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names TODO: Add other useful fields. apiVersion, kind, uid?",
                      "type": [
                        "string",
                        "null"
                      ]
                    }
                  },
                  "x-kubernetes-map-type": "atomic",
                  "additionalProperties": false
                },
                "agentMode": {
                  "description": "AgentMode contains the authentication mode used by the automation agent.",
                  "type": [
                    "string",
                    "null"
                  ],
                  "enum": [
                    "SCRAM",
                    "SCRAM-SHA-256",
                    "SCRAM-SHA-1",
                    "X509"
                  ]
                },
                "ignoreUnknownUsers": {},
                "modes": {
                  "description": "Modes is an array specifying which authentication methods should be enabled.",
                  "type": "array",
                  "items": {
                    "type": [
                      "string",
                      "null"
                    ],
                    "enum": [
                      "SCRAM",
                      "SCRAM-SHA-256",
                      "SCRAM-SHA-1",
                      "X509"
                    ]
                  }
                }
              },
              "additionalProperties": false
            },
            "roles": {
              "description": "User-specified custom MongoDB roles that should be configured in the deployment.",
              "type": [
                "array",
                "null"
              ],
              "items": {
                "description": "CustomRole defines a custom MongoDB role.",
                "type": [
                  "object",
                  "null"
                ],
                "required": [
                  "db",
                  "privileges",
                  "role"
                ],
                "properties": {
                  "authenticationRestrictions": {
                    "description": "The authentication restrictions the server enforces on the role.",
                    "type": [
                      "array",
                      "null"
                    ],
                    "items": {
                      "description": "AuthenticationRestriction specifies a list of IP addresses and CIDR ranges users are allowed to connect to or from.",
                      "type": [
                        "object",
                        "null"
                      ],
                      "required": [
                        "clientSource",
                        "serverAddress"
                      ],
                      "properties": {
                        "clientSource": {
                          "type": "array",
                          "items": {
                            "type": [
                              "string",
                              "null"
                            ]
                          }
                        },
                        "serverAddress": {
                          "type": "array",
                          "items": {
                            "type": [
                              "string",
                              "null"
                            ]
                          }
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "db": {
                    "description": "The database of the role.",
                    "type": "string"
                  },
                  "privileges": {
                    "description": "The privileges to grant the role.",
                    "type": "array",
                    "items": {
                      "description": "Privilege defines the actions a role is allowed to perform on a given resource.",
                      "type": [
                        "object",
                        "null"
                      ],
                      "required": [
                        "actions",
                        "resource"
                      ],
                      "properties": {
                        "actions": {
                          "type": "array",
                          "items": {
                            "type": [
                              "string",
                              "null"
                            ]
                          }
                        },
                        "resource": {
                          "description": "Resource specifies specifies the resources upon which a privilege permits actions. See https://www.mongodb.com/docs/manual/reference/resource-document for more.",
                          "type": "object",
                          "properties": {
                            "anyResource": {
                              "type": [
                                "boolean",
                                "null"
                              ]
                            },
                            "cluster": {
                              "type": [
                                "boolean",
                                "null"
                              ]
                            },
                            "collection": {
                              "type": [
                                "string",
                                "null"
                              ]
                            },
                            "db": {
                              "type": [
                                "string",
                                "null"
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "role": {
                    "description": "The name of the role.",
                    "type": "string"
                  },
                  "roles": {
                    "description": "An array of roles from which this role inherits privileges.",
                    "type": [
                      "array",
                      "null"
                    ],
                    "items": {
                      "description": "Role is the database role this user should have",
                      "type": [
                        "object",
                        "null"
                      ],
                      "required": [
                        "db",
                        "name"
                      ],
                      "properties": {
                        "db": {
                          "description": "DB is the database the role can act on",
                          "type": "string"
                        },
                        "name": {
                          "description": "Name is the name of the role",
                          "type": "string"
                        }
                      },
                      "additionalProperties": false
                    }
                  }
                },
                "additionalProperties": false
              }
            },
            "tls": {
              "description": "TLS configuration for both client-server and server-server communication",
              "type": [
                "object",
                "null"
              ],
              "required": [
                "enabled"
              ],
              "properties": {
                "caCertificateSecretRef": {
                  "description": "CaCertificateSecret is a reference to a Secret containing the certificate for the CA which signed the server certificates The certificate is expected to be available under the key \"ca.crt\"",
                  "type": [
                    "object",
                    "null"
                  ],
                  "properties": {
                    "name": {
                      "description": "Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names TODO: Add other useful fields. apiVersion, kind, uid?",
                      "type": [
                        "string",
                        "null"
                      ]
                    }
                  },
                  "x-kubernetes-map-type": "atomic",
                  "additionalProperties": false
                },
                "caConfigMapRef": {
                  "description": "CaConfigMap is a reference to a ConfigMap containing the certificate for the CA which signed the server certificates The certificate is expected to be available under the key \"ca.crt\" This field is ignored when CaCertificateSecretRef is configured",
                  "type": [
                    "object",
                    "null"
                  ],
                  "properties": {
                    "name": {
                      "description": "Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names TODO: Add other useful fields. apiVersion, kind, uid?",
                      "type": [
                        "string",
                        "null"
                      ]
                    }
                  },
                  "x-kubernetes-map-type": "atomic",
                  "additionalProperties": false
                },
                "certificateKeySecretRef": {
                  "description": "CertificateKeySecret is a reference to a Secret containing a private key and certificate to use for TLS. The key and cert are expected to be PEM encoded and available at \"tls.key\" and \"tls.crt\". This is the same format used for the standard \"kubernetes.io/tls\" Secret type, but no specific type is required. Alternatively, an entry tls.pem, containing the concatenation of cert and key, can be provided. If all of tls.pem, tls.crt and tls.key are present, the tls.pem one needs to be equal to the concatenation of tls.crt and tls.key",
                  "type": [
                    "object",
                    "null"
                  ],
                  "properties": {
                    "name": {
                      "description": "Name of the referent. More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names TODO: Add other useful fields. apiVersion, kind, uid?",
                      "type": [
                        "string",
                        "null"
                      ]
                    }
                  },
                  "x-kubernetes-map-type": "atomic",
                  "additionalProperties": false
                },
                "enabled": {
                  "type": "boolean"
                },
                "optional": {
                  "description": "Optional configures if TLS should be required or optional for connections",
                  "type": [
                    "boolean",
                    "null"
                  ]
                }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "statefulSet": {
          "description": "StatefulSetConfiguration holds the optional custom StatefulSet that should be merged into the operator created one.",
          "type": [
            "object",
            "null"
          ],
          "required": [
            "spec"
          ],
          "properties": {
            "metadata": {
              "description": "StatefulSetMetadataWrapper is a wrapper around Labels and Annotations",
              "type": [
                "object",
                "null"
              ],
              "properties": {
                "annotations": {
                  "type": [
                    "object",
                    "null"
                  ],
                  "additionalProperties": {
                    "type": [
                      "string",
                      "null"
                    ]
                  }
                },
                "labels": {
                  "type": [
                    "object",
                    "null"
                  ],
                  "additionalProperties": {
                    "type": [
                      "string",
                      "null"
                    ]
                  }
                }
              },
              "additionalProperties": false
            },
            "spec": {
              "x-kubernetes-preserve-unknown-fields": true
            }
          },
          "additionalProperties": false
        },
        "type": {
          "description": "Type defines which type of MongoDB deployment the resource should create",
          "type": "string",
          "enum": [
            "ReplicaSet"
          ]
        },
        "users": {
          "description": "Users specifies the MongoDB users that should be configured in your deployment",
          "type": "array",
          "items": {
            "type": [
              "object",
              "null"
            ],
            "required": [
              "name",
              "roles"
            ],
            "properties": {
              "additionalConnectionStringConfig": {
                "description": "Additional options to be appended to the connection string. These options apply only to this user and will override any existing options in the resource.",
                "x-kubernetes-preserve-unknown-fields": true
              },
              "connectionStringSecretName": {
                "description": "ConnectionStringSecretName is the name of the secret object created by the operator which exposes the connection strings for the user. If provided, this secret must be different for each user in a deployment.",
                "type": [
                  "string",
                  "null"
                ]
              },
              "db": {
                "description": "DB is the database the user is stored in. Defaults to \"admin\"",
                "type": [
                  "string",
                  "null"
                ]
              },
              "name": {
                "description": "Name is the username of the user",
                "type": "string"
              },
              "passwordSecretRef": {
                "description": "PasswordSecretRef is a reference to the secret containing this user's password",
                "type": [
                  "object",
                  "null"
                ],
                "required": [
                  "name"
                ],
                "properties": {
                  "key": {
                    "description": "Key is the key in the secret storing this password. Defaults to \"password\"",
                    "type": [
                      "string",
                      "null"
                    ]
                  },
                  "name": {
                    "description": "Name is the name of the secret storing this user's password",
                    "type": "string"
                  }
                },
                "additionalProperties": false
              },
              "roles": {
                "description": "Roles is an array of roles assigned to this user",
                "type": "array",
                "items": {
                  "description": "Role is the database role this user should have",
                  "type": [
                    "object",
                    "null"
                  ],
                  "required": [
                    "db",
                    "name"
                  ],
                  "properties": {
                    "db": {
                      "description": "DB is the database the role can act on",
                      "type": "string"
                    },
                    "name": {
                      "description": "Name is the name of the role",
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                }
              },
              "scramCredentialsSecretName": {
                "description": "ScramCredentialsSecretName appended by string \"scram-credentials\" is the name of the secret object created by the mongoDB operator for storing SCRAM credentials These secrets names must be different for each user in a deployment.",
                "type": [
                  "string",
                  "null"
                ],
                "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$"
              }
            },
            "additionalProperties": false
          }
        },
        "version": {
          "description": "Version defines which version of MongoDB will be used",
          "type": [
            "string",
            "null"
          ]
        }
      },
      "additionalProperties": false
    },
    "status": {
      "description": "MongoDBCommunityStatus defines the observed state of MongoDB",
      "type": [
        "object",
        "null"
      ],
      "required": [
        "currentMongoDBMembers",
        "currentStatefulSetReplicas",
        "mongoUri",
        "phase"
      ],
      "properties": {
        "currentMongoDBArbiters": {
          "type": [
            "integer",
            "null"
          ]
        },
        "currentMongoDBMembers": {
          "type": "integer"
        },
        "currentStatefulSetArbitersReplicas": {
          "type": [
            "integer",
            "null"
          ]
        },
        "currentStatefulSetReplicas": {
          "type": "integer"
        },
        "message": {
          "type": [
            "string",
            "null"
          ]
        },
        "mongoUri": {
          "type": "string"
        },
        "phase": {
          "type": "string"
        },
        "version": {
          "type": [
            "string",
            "null"
          ]
        }
      },
      "additionalProperties": false
    }
  },
  "x-kubernetes-group-version-kind": [
    {
      "group": "mongodbcommunity.mongodb.com",
      "kind": "MongoDBCommunity",
      "version": "v1"
    }
  ],
  "additionalProperties": false,
  "$schema": "http://json-schema.org/schema#"
}